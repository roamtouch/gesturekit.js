/*! GestureKit Helper v2.1.1 http://gesturekit.com/ | Released under the Apache v2 License. */!function(a,b){"use strict";function c(a){return['<div class="gk-helper-gesture">','<img src="data:image/png;base64,'+a.img+'" height="120" width="120">','<p class="gk-helper-label">'+a.method+"</p>",'<p class="gk-helper-label">'+a.img_description+"</p>","</div>"].join("")}function d(a,b,c){c=c||h.body;var d=document.createElement(a);return d.className=b,c.appendChild(d),d}function e(a){var b;for(b in o)a.hasOwnProperty(b)||(a[b]=o[b]);return a}function f(a){return this._init(a),this}function g(a){return new f(a)}var h=a.document,i=h.documentElement,j=a.navigator.msPointerEnabled,k={start:j?"MSPointerDown":"touchstart",move:j?"MSPointerMove":"touchmove",end:j?"MSPointerUp":"touchend"},l="https://i.cloudup.com/jAmu8s95gF-3000x3000.png",m="http://api.gesturekit.com/v1.1/index.php/sdk/getgestures_help/",n=h.documentElement,o={size:60,container:h.body,drag:!0,snap:!0,title:"Gestures"},p=function(){var a,b=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/,c=h.getElementsByTagName("script")[0].style;for(a in c)if(b.test(a))return"-"+a.match(b)[0].toLowerCase()+"-";return"WebkitOpacity"in c?"-webkit-":"KhtmlOpacity"in c?"-khtml-":""}();f.prototype._init=function(a){var c=this;return this._options=e(a||{}),this.container=this._options.container,this.lastPoint={},this._motion=!1,this._move=!1,this.currentOffset={x:2,y:60},this._createDisplay(),this._defineEvents(),this._options.drag&&this.drag(),this._createShowroom(),b.on("HELP",function(){c.showGestures()}),this},f.prototype._createDisplay=function(){var a=["background-color: #999999;",'background-image: url("'+l+'");',"background-size: cover;","border-radius: 10px;","position: fixed;","top: 0;","left: 0;","z-index: 999;"];return this.display=h.createElement("canvas"),this.display.width=this.display.height=this._options.size,this.display.style.cssText=a.join(""),this.display.className="gk-helper-display",this.display.style[p+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",this._ctx=this.display.getContext("2d"),this.container.appendChild(this.display),this},f.prototype._defineEvents=function(){var a=this;return b.on("gesturestart",function(b){a._draw(b.touches)}),b.on("gesturemotion",function(b){a._draw(b.touches)}),b.on("gestureend",function(){setTimeout(function(){a._finishDrawing()},10)}),this},f.prototype.drag=function(){var a=this,c={x:0,y:0};return i.addEventListener(k.start,function(d){d.target===a.display&&(b.disable(),c.x=d.touches[0].pageX-a.currentOffset.x,c.y=d.touches[0].pageY-a.currentOffset.y)}),i.addEventListener(k.move,function(b){if(b.target===a.display){b.preventDefault();var d=b.touches[0].pageX-c.x,e=b.touches[0].pageY-c.y;return a.display.style[p+"transform"]="translate("+d+"px,"+e+"px)",a.currentOffset.x=d,a.currentOffset.y=e,a._move=!0,void 0}}),i.addEventListener(k.end,function(c){c.target===a.display&&(a._options.snap&&a._snap(),b.enable(),a._move||a.showGestures(),a._move=!1)}),this},f.prototype._scalePoints=function(a,b){var c={},d={},e={},f=this.display,g=n.clientWidth,h=n.clientHeight,i=this.display.width,j=this.display.height;return g>h?(j=h*f.width/g,c.x=0,c.y=(f.height-j)/2):(i=g*f.height/h,c.y=0,c.x=(f.width-i)/2),e.x=g/i,e.y=h/j,d.x=a/e.x+c.x,d.y=b/e.y+c.y,d},f.prototype._draw=function(a){var b,c,d,e=0,f=a.length,g=this._ctx,h=this.display.style;for("none"!==h.backgroundImage&&(h.backgroundImage="none"),e;f>e;e+=1)c=a[e],b=c.identifier,d=this._scalePoints(c.pageX,c.pageY),g.beginPath(),this.lastPoint[b]?(g.moveTo(this.lastPoint[b].x,this.lastPoint[b].y),g.lineTo(d.x,d.y),g.strokeStyle="#FFF",g.lineWidth=3,g.lineCap="round",g.stroke()):(g.arc(d.x,d.y,3.5,0,2*Math.PI),g.fillStyle="#FFF",g.fill()),this.lastPoint[b]={x:d.x,y:d.y};return this},f.prototype._finishDrawing=function(){return this.display.style.backgroundImage='url("'+l+'")',this.lastPoint={},this._ctx.clearRect(0,0,this.display.width,this.display.height),this},f.prototype._snap=function(){var b=this,c=n.clientWidth,d=n.clientHeight,e=this.display.clientWidth,f=this.display.clientHeight,g=this.currentOffset.y,h=this.currentOffset.x;return this.currentOffset.x<e/2?h=2:this.currentOffset.x+e>c-e/2&&(h=c-e-2),this.currentOffset.y<f?g=2:this.currentOffset.y+f>d-f?g=d-f-2:h=this.currentOffset.x+e/2>c/2?c-e-2:2,this.currentOffset.y=g,this.currentOffset.x=h,this.display.style.transition=p+"transform 200ms ease-in-out",this.display.style[p+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",a.setTimeout(function(){b.display.style.transition="none"},200),this},f.prototype.show=function(){return this._enabled=!0,this.display.style.display="block",this},f.prototype.hide=function(){return this._enabled=!1,this.display.style.display="none",this},f.prototype._createShowroom=function(){var a=this,b={};return b.container=d("div","gk-helper-container gk-helper-hide"),b.title=d("h2","gk-helper-title",b.container),b.title.innerHTML=this._options.title,b.closeBtn=d("button","gk-helper-close",b.container),b.closeBtn.addEventListener("touchend",function(){a.hideGestures()}),this.showroom=b,this.loadGestures(),this},f.prototype.showGestures=function(){return this.showroom.container.style.display="block",b.disable(),this},f.prototype.hideGestures=function(){return this.showroom.container.style.display="none",b.enable(),this},f.prototype.loadGestures=function(c){var d,e,f=this,g=new a.XMLHttpRequest;return c=c||b._options.gid,g.open("GET",m+c),g.onreadystatechange=function(){g.readyState===g.DONE&&(d=g.status,(d>=200&&300>d||304===d||0===d)&&(e=JSON.parse(g.response||g.responseText),f.renderGestures(e.gestureset.gestures)))},g.send(),this},f.prototype.renderGestures=function(a){var b="";return a.forEach(function(a){b+=c(a)}),this.showroom.container.insertAdjacentHTML("beforeend",b),this},"function"==typeof a.define&&void 0!==a.define.amd?a.define("helper",[],function(){return g}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=g:a.gesturekit.helper=g}(this,this.gesturekit);